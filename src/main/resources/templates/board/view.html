<!DOCTYPE html>
<html lang="en">

<head th:replace="common/head"></head>

<body>

  <div th:replace="common/header"></div>
  <nav th:replace="common/nav"></nav>

  <div class="container mt-5">
    <div class="card">
      <div class="card-body">
        <span class="badge bg-primary rounded-pill" th:text="${board.id} + 'ë²ˆ'"></span>
        <h5 class="card-title" th:text="${board.title}"></h5>
        <h8 class="card-subtitle mb-2 text-muted" th:text="${board.userId}"></h8>
        <p class="card-text" th:text="${board.content}"></p>

        <form action="/board/comment" method="post">
          <input type="text" name="content">
          <input type="hidden" name="boardId" th:value="${board.id}">
          <button type="submit">ëŒ“ê¸€ğŸ˜Šë‹¬ê¸°</button>
        </form>
        <hr>
        ëŒ“ê¸€âœï¸
        <ul th:each="comment : ${board.comments}">
          <li>[[ ${comment.content} ]] / [[ ${session.user_info.name} ]] / [[ ${comment.creDate} ]]
            <button th:onclick="'commentRm(' + ${comment.id} +')'">ëŒ“ì‚­ğŸ¥²</button>
          </li>
        </ul>
        <hr>
        ì²¨ë¶€ëœ íŒŒì¼ğŸ“¥
        <ul th:each="fileAtch : ${board.fileAtchs}">
          <li>
            <a th:href="@{/download(id=${fileAtch.id})}">
              [[${fileAtch.originalName}]]
            </a>
            <button th:onclick="'fileRm(' + ${fileAtch.id} +')'">íŒŒì¼ì‚­ì œâœ‚ï¸</button>
          </li>
        </ul>

      </div>
    </div>
  </div>
  <div class="container mt-5">
    <ul class="nav justify-content-end">
      <li class="nav-item">
        <a class="nav-link" th:href="@{/board/list}" id="list">ëª©ë¡</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#" th:href="@{'/board/update/' + ${board.id}}" id="update">ìˆ˜ì •</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#" th:data-num="${board.id}" id="delete">ì‚­ì œ</a>
      </li>
    </ul>
  </div>

  <!-- <div th:replace="common/footer">
  </div> -->

  <script>

    document.querySelector('#delete').addEventListener('click', (e) => {
      e.preventDefault();
      if (confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        const num = e.target.dataset.num;
        if (num !== "null")
        location = `/board/delete/${num}`;
      }
    });

    function commentRm(id) {
      const isOk = confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
      if (isOk) {
        location = `/board/comment/remove?id=${id}&boardId=[[${board.id}]]`;
      }
    }

    function fileRm(id) {
      const isOk = confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
      if (isOk) {
        location = `/board/fileAtch/remove?id=${id}&boardId=[[${board.id}]]`;
      }
    }
  </script>
</body>

</html>